<link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined" rel="stylesheet">
<div style="font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Helvetica,Arial,sans-serif;line-height:1.6;color:#fff;background-color:#3b4055;margin:0;padding:20px;max-width:980px;margin:0 auto">
    <img src="https://raw.githubusercontent.com/nicolaiprodromov/dot_node/refs/heads/master/docs/Asset%2026.png" alt="Node Extension Preview" style="max-width:100%;height:auto;display:block;margin:0 auto">
    
    <div style="text-align:center;margin:20px 0">
        <a href="https://github.com/nicolaiprodromov/dot_node/releases">
            <img src="https://img.shields.io/badge/version-1.0.0-blue.svg" alt="Version" style="display:inline-block;margin:0 2px">
        </a>
        <a href="https://www.blender.org">
            <img src="https://img.shields.io/badge/Blender-4.1%2B-orange.svg" alt="Blender" style="display:inline-block;margin:0 2px">
        </a>
        <a href="https://xwz.app">
            <img src="https://img.shields.io/badge/join-community-ff69b4.svg" alt="Community" style="display:inline-block;margin:0 2px">
        </a>
    </div>
    
    <div style="text-align:center;margin:20px 0">
        <h3 style="font-size:1.5em;margin:24px 0 16px;font-weight:600;line-height:1.25;color:#fff">Technical Documentation for <code style="padding:0.2em 0.4em;margin:0;font-size:85%;background-color:#2e3244;border-radius:3px;font-family:SFMono-Regular,Consolas,'Liberation Mono',Menlo,monospace;border:1px solid #3b4055;color:rgba(255,255,255,0.7)">.node</code></h3>
        <p style="margin:0 0 16px;color:rgba(255,255,255,0.7)"><em style="font-style:italic;color:rgba(255,255,255,0.7)">Deep dive into the architecture, implementation, and technical specifications of the Node File Link addon.</em></p>
        <p style="margin:0 0 16px;color:rgba(255,255,255,0.7)">This documentation covers the internal workings of the <code style="padding:0.2em 0.4em;margin:0;font-size:85%;background-color:#2e3244;border-radius:3px;font-family:SFMono-Regular,Consolas,'Liberation Mono',Menlo,monospace;border:1px solid #3b4055;color:rgba(255,255,255,0.7)">.node</code> file format, serialization engine, and Blender integration mechanisms that power seamless node group sharing and distribution.</p>
    </div>
    
    <div style="margin:24px 0;height:0;border:0"></div>
    
    <div style="text-align:center;margin:20px 0">
        <table style="border-spacing:0;border-collapse:collapse;margin:20px auto;border:none;background:transparent">
            <tr style="border:none;background:transparent">
                <td style="border:none;padding:10px;background:transparent;vertical-align:top;text-align:center;width:120px">
                    <a href="https://github.com/nicolaiprodromov/dot_node/releases" style="color:#64b5f6;text-decoration:none;background:transparent;display:flex;flex-direction:column;align-items:center;justify-content:flex-start;text-align:center;line-height:1.4;min-height:90px">
                        <img src="https://raw.githubusercontent.com/nicolaiprodromov/dot_node/refs/heads/master/docs/logo_git.png" width="70" style="max-width:100%;height:auto;filter:invert(1);margin-bottom:8px">
                        <br>Get for Free
                    </a>
                </td>
                <td style="border:none;padding:10px;background:transparent;vertical-align:top;text-align:center;width:120px">
                    <a href="https://superhivemarket.com" style="color:#64b5f6;text-decoration:none;background:transparent;display:flex;flex-direction:column;align-items:center;justify-content:flex-start;text-align:center;line-height:1.4;min-height:90px">
                        <img src="https://raw.githubusercontent.com/nicolaiprodromov/dot_node/refs/heads/master/docs/logo_superhive.png" width="70" style="max-width:100%;height:auto;margin-bottom:8px">
                        <br>Buy on Superhive
                    </a>
                </td>
                <td style="border:none;padding:10px;background:transparent;vertical-align:top;text-align:center;width:120px">
                    <a href="https://blenderkit.com" style="color:#64b5f6;text-decoration:none;background:transparent;display:flex;flex-direction:column;align-items:center;justify-content:flex-start;text-align:center;line-height:1.4;min-height:90px">
                        <img src="https://raw.githubusercontent.com/nicolaiprodromov/dot_node/refs/heads/master/docs/logo_blenderkit.png" width="70" style="max-width:100%;height:auto;margin-bottom:8px">
                        <br>Buy on BlenderKit
                    </a>
                </td>
            </tr>
        </table>
    </div>
    
    <div style="margin:24px 0;height:0;border:0"></div>
    
    <ul style="padding-left:2em;margin:0 0 16px;color:rgba(255,255,255,0.7)">
        <li style="margin-bottom:4px;color:rgba(255,255,255,0.7)"><strong style="font-weight:600;color:rgba(255,255,255,0.7)">Advanced Serialization</strong>: Complete node tree serialization with metadata, properties, and interface definitions</li>
        <li style="margin-bottom:4px;color:rgba(255,255,255,0.7)"><strong style="font-weight:600;color:rgba(255,255,255,0.7)">Cross-Version Compatibility</strong>: Handles Blender 4.1+ interface changes and node tree variations</li>
        <li style="margin-bottom:4px;color:rgba(255,255,255,0.7)"><strong style="font-weight:600;color:rgba(255,255,255,0.7)">Windows Registry Integration</strong>: Automatic file association registration with custom icon support</li>
        <li style="margin-bottom:4px;color:rgba(255,255,255,0.7)"><strong style="font-weight:600;color:rgba(255,255,255,0.7)">Real-time Import System</strong>: Drag & drop functionality with cursor-aware node placement</li>
    </ul>
    
    <blockquote style="padding:0 1em;color:rgba(255,255,255,0.7);border-left:0.25em solid #64b5f6;margin:0 0 16px;background-color:#2e3244;border-radius:3px">
        <p style="margin:0 0 16px;color:rgba(255,255,255,0.7)"><em style="font-style:italic;color:rgba(255,255,255,0.7)">Deep dive into the architecture, implementation, and technical specifications of the Node File Link addon.</em></p>
    </blockquote>
    
    <h2 style="font-size:1.5em;margin:24px 0 16px;font-weight:600;line-height:1.25;border-bottom:1px solid #2e3244;padding-bottom:0.3em;color:#fff"><span style="font-family:'Material Symbols Outlined';font-weight:normal;font-style:normal;font-size:28px;line-height:1;letter-spacing:normal;text-transform:none;display:inline-block;white-space:nowrap;word-wrap:normal;direction:ltr;-webkit-font-smoothing:antialiased;vertical-align:middle;margin-right:8px">folder_open</span>File Format Specification</h2>
    
    <h3 style="font-size:1.5em;margin:24px 0 16px;font-weight:600;line-height:1.25;color:#fff">Internal Structure</h3>
    
    <p style="margin:0 0 16px;color:rgba(255,255,255,0.7)">A <code style="padding:0.2em 0.4em;margin:0;font-size:85%;background-color:#2e3244;border-radius:3px;font-family:SFMono-Regular,Consolas,'Liberation Mono',Menlo,monospace;border:1px solid #3b4055;color:rgba(255,255,255,0.7)">.node</code> file is a ZIP archive containing exactly three components:</p>
    
    <table style="border-spacing:0;border-collapse:collapse;margin:20px auto;background-color:#3a4450;width:100%">
        <tr style="background-color:#2e3244;border-top:1px solid #3b4055;color:rgba(255,255,255,0.7)">
            <td style="padding:8px 16px;border:1px solid #4a5568;vertical-align:top;color:rgba(255,255,255,0.7)"><strong style="font-weight:600;color:rgba(255,255,255,0.7)">Component</strong></td>
            <td style="padding:8px 16px;border:1px solid #4a5568;vertical-align:top;color:rgba(255,255,255,0.7)"><strong style="font-weight:600;color:rgba(255,255,255,0.7)">Filename</strong></td>
            <td style="padding:8px 16px;border:1px solid #4a5568;vertical-align:top;color:rgba(255,255,255,0.7)"><strong style="font-weight:600;color:rgba(255,255,255,0.7)">Purpose</strong></td>
            <td style="padding:8px 16px;border:1px solid #4a5568;vertical-align:top;color:rgba(255,255,255,0.7)"><strong style="font-weight:600;color:rgba(255,255,255,0.7)">Format</strong></td>
        </tr>
        <tr style="background-color:#252938;color:rgba(255,255,255,0.7)">
            <td style="padding:8px 16px;border:1px solid #4a5568;vertical-align:top;color:rgba(255,255,255,0.7)"><strong style="font-weight:600;color:rgba(255,255,255,0.7)">Metadata</strong></td>
            <td style="padding:8px 16px;border:1px solid #4a5568;vertical-align:top;color:rgba(255,255,255,0.7)"><code style="padding:0.2em 0.4em;margin:0;font-size:85%;background-color:#2e3244;border-radius:3px;font-family:SFMono-Regular,Consolas,'Liberation Mono',Menlo,monospace;border:1px solid #3b4055;color:rgba(255,255,255,0.7)">{package_name}.json</code></td>
            <td style="padding:8px 16px;border:1px solid #4a5568;vertical-align:top;color:rgba(255,255,255,0.7)">Node structure, properties, and interface definitions</td>
            <td style="padding:8px 16px;border:1px solid #4a5568;vertical-align:top;color:rgba(255,255,255,0.7)">JSON with UTF-8 encoding</td>
        </tr>
        <tr style="background-color:#2e3244;border-top:1px solid #3b4055;color:rgba(255,255,255,0.7)">
            <td style="padding:8px 16px;border:1px solid #4a5568;vertical-align:top;color:rgba(255,255,255,0.7)"><strong style="font-weight:600;color:rgba(255,255,255,0.7)">Node Data</strong></td>
            <td style="padding:8px 16px;border:1px solid #4a5568;vertical-align:top;color:rgba(255,255,255,0.7)"><code style="padding:0.2em 0.4em;margin:0;font-size:85%;background-color:#2e3244;border-radius:3px;font-family:SFMono-Regular,Consolas,'Liberation Mono',Menlo,monospace;border:1px solid #3b4055;color:rgba(255,255,255,0.7)">{package_name}.blend</code></td>
            <td style="padding:8px 16px;border:1px solid #4a5568;vertical-align:top;color:rgba(255,255,255,0.7)">Actual Blender node group data for importing</td>
            <td style="padding:8px 16px;border:1px solid #4a5568;vertical-align:top;color:rgba(255,255,255,0.7)">Standard Blender file</td>
        </tr>
        <tr style="background-color:#252938;color:rgba(255,255,255,0.7)">
            <td style="padding:8px 16px;border:1px solid #4a5568;vertical-align:top;color:rgba(255,255,255,0.7)"><strong style="font-weight:600;color:rgba(255,255,255,0.7)">Package Config</strong></td>
            <td style="padding:8px 16px;border:1px solid #4a5568;vertical-align:top;color:rgba(255,255,255,0.7)"><code style="padding:0.2em 0.4em;margin:0;font-size:85%;background-color:#2e3244;border-radius:3px;font-family:SFMono-Regular,Consolas,'Liberation Mono',Menlo,monospace;border:1px solid #3b4055;color:rgba(255,255,255,0.7)">.config</code></td>
            <td style="padding:8px 16px;border:1px solid #4a5568;vertical-align:top;color:rgba(255,255,255,0.7)">Package validation and integrity verification</td>
            <td style="padding:8px 16px;border:1px solid #4a5568;vertical-align:top;color:rgba(255,255,255,0.7)">Plain text key=value pairs</td>
        </tr>
    </table>
    
    <h3 style="font-size:1.5em;margin:24px 0 16px;font-weight:600;line-height:1.25;color:#fff">JSON Metadata Schema</h3>
    
    <p style="margin:0 0 16px;color:rgba(255,255,255,0.7)">The JSON metadata follows a structured schema that captures complete node tree information:</p>
    
    <pre style="padding:16px;overflow:auto;font-size:85%;line-height:1.45;background-color:#2e3244;border-radius:6px;font-family:SFMono-Regular,Consolas,'Liberation Mono',Menlo,monospace;border:1px solid #3b4055;color:rgba(255,255,255,0.7)"><code style="display:inline;max-width:auto;padding:0;margin:0;overflow:visible;line-height:inherit;word-wrap:normal;background-color:transparent;border:0;color:#fff">{
  "nodegroup_info": {
    "name": "string",              // Original node group name
    "package_name": "string",      // Sanitized package identifier
    "description": "string",       // Node group description
    "type": "GeometryNodeTree",    // Blender node tree type
    "version": "1.0.0",           // Package format version
    "blender_version": "string",   // Source Blender version
    "export_timestamp": "ISO8601"  // Creation timestamp
  },
  "interface": {
    "inputs": [...],              // Input socket definitions
    "outputs": [...]              // Output socket definitions
  },
  "nodes": [...],                 // Individual node data
  "links": [...],                 // Node connections
  "layout": {                     // Visual layout information
    "frames": [...],              // Frame node data
    "reroutes": [...]             // Reroute node positions
  },
  "dependencies": {               // External dependencies
    "node_groups": [...],         // Required node groups
    "materials": [...],           // Material dependencies
    "objects": [...],             // Object references
    "images": [...],              // Image textures
    "texts": [...]                // Text datablocks
  }
}</code></pre>
    
    <h4 style="font-size:1.25em;margin:24px 0 16px;font-weight:600;line-height:1.25;color:#fff">Socket Serialization</h4>
    
    <p style="margin:0 0 16px;color:rgba(255,255,255,0.7)">Socket data includes comprehensive type information and default values:</p>
    
    <pre style="padding:16px;overflow:auto;font-size:85%;line-height:1.45;background-color:#2e3244;border-radius:6px;font-family:SFMono-Regular,Consolas,'Liberation Mono',Menlo,monospace;border:1px solid #3b4055;color:rgba(255,255,255,0.7)"><code style="display:inline;max-width:auto;padding:0;margin:0;overflow:visible;line-height:inherit;word-wrap:normal;background-color:transparent;border:0;color:#fff">{
  "name": "string",
  "identifier": "string",         // Unique socket identifier
  "socket_type": "string",        // Blender socket type (bl_idname)
  "in_out": "INPUT|OUTPUT",       // Socket direction
  "description": "string",        // User description
  "default_value": "variant",     // Serialized default value
  "min_value": "number",          // Optional range constraints
  "max_value": "number",
  "subtype": "string",            // Socket subtype information
  "attribute_domain": "string"    // Geometry domain (4.5+)
}</code></pre>
    
    <h3 style="font-size:1.5em;margin:24px 0 16px;font-weight:600;line-height:1.25;color:#fff">Package Validation System</h3>
    
    <p style="margin:0 0 16px;color:rgba(255,255,255,0.7)">The <code style="padding:0.2em 0.4em;margin:0;font-size:85%;background-color:#2e3244;border-radius:3px;font-family:SFMono-Regular,Consolas,'Liberation Mono',Menlo,monospace;border:1px solid #3b4055;color:rgba(255,255,255,0.7)">.config</code> file contains integrity verification data:</p>
    
    <pre style="padding:16px;overflow:auto;font-size:85%;line-height:1.45;background-color:#2e3244;border-radius:6px;font-family:SFMono-Regular,Consolas,'Liberation Mono',Menlo,monospace;border:1px solid #3b4055;color:rgba(255,255,255,0.7)"><code style="display:inline;max-width:auto;padding:0;margin:0;overflow:visible;line-height:inherit;word-wrap:normal;background-color:transparent;border:0;color:#fff">hash=sha256_hash_of_all_files
created=2025-09-07T12:34:56Z
format_version=1.0.0</code></pre>
    
    <p style="margin:0 0 16px;color:rgba(255,255,255,0.7)">The hash is computed from all file contents in the package, ensuring data integrity during transfer and storage.</p>
    
    <h2 style="font-size:1.5em;margin:24px 0 16px;font-weight:600;line-height:1.25;border-bottom:1px solid #2e3244;padding-bottom:0.3em;color:#fff"><span style="font-family:'Material Symbols Outlined';font-weight:normal;font-style:normal;font-size:28px;line-height:1;letter-spacing:normal;text-transform:none;display:inline-block;white-space:nowrap;word-wrap:normal;direction:ltr;-webkit-font-smoothing:antialiased;vertical-align:middle;margin-right:8px">settings</span>Serialization Engine</h2>
    
    <h3 style="font-size:1.5em;margin:24px 0 16px;font-weight:600;line-height:1.25;color:#fff">NodeGroupSerializer Class</h3>
    
    <p style="margin:0 0 16px;color:rgba(255,255,255,0.7)">The serialization engine handles the complex task of converting Blender's internal node tree representation into a portable format:</p>
    
    <h4 style="font-size:1.25em;margin:24px 0 16px;font-weight:600;line-height:1.25;color:#fff">Core Serialization Methods</h4>
    
    <table style="border-spacing:0;border-collapse:collapse;margin:20px auto;background-color:#3a4450;width:100%">
        <tr style="background-color:#2e3244;border-top:1px solid #3b4055;color:rgba(255,255,255,0.7)">
            <td style="padding:8px 16px;border:1px solid #4a5568;vertical-align:top;color:rgba(255,255,255,0.7)"><strong style="font-weight:600;color:rgba(255,255,255,0.7)">Method</strong></td>
            <td style="padding:8px 16px;border:1px solid #4a5568;vertical-align:top;color:rgba(255,255,255,0.7)"><strong style="font-weight:600;color:rgba(255,255,255,0.7)">Purpose</strong></td>
            <td style="padding:8px 16px;border:1px solid #4a5568;vertical-align:top;color:rgba(255,255,255,0.7)"><strong style="font-weight:600;color:rgba(255,255,255,0.7)">Output</strong></td>
        </tr>
        <tr style="background-color:#252938;color:rgba(255,255,255,0.7)">
            <td style="padding:8px 16px;border:1px solid #4a5568;vertical-align:top;color:rgba(255,255,255,0.7)"><code style="padding:0.2em 0.4em;margin:0;font-size:85%;background-color:#2e3244;border-radius:3px;font-family:SFMono-Regular,Consolas,'Liberation Mono',Menlo,monospace;border:1px solid #3b4055;color:rgba(255,255,255,0.7)">_serialize_interface()</code></td>
            <td style="padding:8px 16px;border:1px solid #4a5568;vertical-align:top;color:rgba(255,255,255,0.7)">Extract input/output socket definitions</td>
            <td style="padding:8px 16px;border:1px solid #4a5568;vertical-align:top;color:rgba(255,255,255,0.7)">Interface structure with socket metadata</td>
        </tr>
        <tr style="background-color:#2e3244;border-top:1px solid #3b4055;color:rgba(255,255,255,0.7)">
            <td style="padding:8px 16px;border:1px solid #4a5568;vertical-align:top;color:rgba(255,255,255,0.7)"><code style="padding:0.2em 0.4em;margin:0;font-size:85%;background-color:#2e3244;border-radius:3px;font-family:SFMono-Regular,Consolas,'Liberation Mono',Menlo,monospace;border:1px solid #3b4055;color:rgba(255,255,255,0.7)">_serialize_nodes()</code></td>
            <td style="padding:8px 16px;border:1px solid #4a5568;vertical-align:top;color:rgba(255,255,255,0.7)">Capture individual node properties and settings</td>
            <td style="padding:8px 16px;border:1px solid #4a5568;vertical-align:top;color:rgba(255,255,255,0.7)">Complete node data with properties</td>
        </tr>
        <tr style="background-color:#252938;color:rgba(255,255,255,0.7)">
            <td style="padding:8px 16px;border:1px solid #4a5568;vertical-align:top;color:rgba(255,255,255,0.7)"><code style="padding:0.2em 0.4em;margin:0;font-size:85%;background-color:#2e3244;border-radius:3px;font-family:SFMono-Regular,Consolas,'Liberation Mono',Menlo,monospace;border:1px solid #3b4055;color:rgba(255,255,255,0.7)">_serialize_links()</code></td>
            <td style="padding:8px 16px;border:1px solid #4a5568;vertical-align:top;color:rgba(255,255,255,0.7)">Map all node connections and relationships</td>
            <td style="padding:8px 16px;border:1px solid #4a5568;vertical-align:top;color:rgba(255,255,255,0.7)">Connection data with socket identifiers</td>
        </tr>
        <tr style="background-color:#2e3244;border-top:1px solid #3b4055;color:rgba(255,255,255,0.7)">
            <td style="padding:8px 16px;border:1px solid #4a5568;vertical-align:top;color:rgba(255,255,255,0.7)"><code style="padding:0.2em 0.4em;margin:0;font-size:85%;background-color:#2e3244;border-radius:3px;font-family:SFMono-Regular,Consolas,'Liberation Mono',Menlo,monospace;border:1px solid #3b4055;color:rgba(255,255,255,0.7)">_serialize_layout()</code></td>
            <td style="padding:8px 16px;border:1px solid #4a5568;vertical-align:top;color:rgba(255,255,255,0.7)">Preserve visual arrangement (frames, reroutes)</td>
            <td style="padding:8px 16px;border:1px solid #4a5568;vertical-align:top;color:rgba(255,255,255,0.7)">Layout positioning information</td>
        </tr>
    </table>
    
    <h4>Blender Version Compatibility</h4>
    
    <p>The serializer handles interface differences between Blender versions:</p>
    
    <pre><code>// Blender 4.5+ Interface API
if hasattr(self.node_group, 'interface') and hasattr(self.node_group.interface, 'items_tree'):
    for item in self.node_group.interface.items_tree:
        if hasattr(item, 'item_type') and item.item_type == 'SOCKET':
            // Process modern interface structure
            
// Fallback for Blender 4.1-4.4
elif hasattr(self.node_group, 'inputs') and hasattr(self.node_group, 'outputs'):
    for input_socket in self.node_group.inputs:
        // Process legacy interface structure</code></pre>
    
    <h3>Advanced Property Handling</h3>
    
    <p>The serializer captures node-specific properties including:</p>
    
    <ul>
        <li><strong>Mathematical Properties</strong>: <code>operation</code>, <code>blend_type</code>, <code>distribution</code>, <code>mode</code></li>
        <li><strong>Data Properties</strong>: <code>data_type</code>, <code>domain</code>, <code>interpolation</code>, <code>resolution</code></li>
        <li><strong>Control Properties</strong>: <code>use_clamp</code>, <code>clamp_factor</code>, <code>offset</code>, <code>scale</code></li>
        <li><strong>Custom Properties</strong>: User-defined properties via <code>node.keys()</code></li>
    </ul>
    
    <h4>Default Value Serialization</h4>
    
    <p>Complex data types are handled with appropriate serialization:</p>
    
    <pre><code>def _serialize_socket_default_value(self, socket):
    if not hasattr(socket, 'default_value'):
        return None
    
    try:
        value = socket.default_value
        
        # Handle Blender math types
        if hasattr(value, '__iter__') and not isinstance(value, str):
            return list(value)  # Vector, Color, Euler
        elif hasattr(value, 'copy'):
            return value.copy()  # Ensure immutable copy
        else:
            return value  # Primitive types
            
    except Exception:
        return None  # Fallback for unsupported types</code></pre>
    
    <h2 style="font-size:1.5em;margin:24px 0 16px;font-weight:600;line-height:1.25;border-bottom:1px solid #2e3244;padding-bottom:0.3em;color:#fff"><span style="font-family:'Material Symbols Outlined';font-weight:normal;font-style:normal;font-size:28px;line-height:1;letter-spacing:normal;text-transform:none;display:inline-block;white-space:nowrap;word-wrap:normal;direction:ltr;-webkit-font-smoothing:antialiased;vertical-align:middle;margin-right:8px">input</span>Import & Unpacking System</h2>
    
    <h3 style="font-size:1.5em;margin:24px 0 16px;font-weight:600;line-height:1.25;color:#fff">NodeGroupUnpacker Class</h3>
    
    <p style="margin:0 0 16px;color:rgba(255,255,255,0.7)">The unpacking system reconstructs Blender node trees from <code style="padding:0.2em 0.4em;margin:0;font-size:85%;background-color:#2e3244;border-radius:3px;font-family:SFMono-Regular,Consolas,'Liberation Mono',Menlo,monospace;border:1px solid #3b4055;color:rgba(255,255,255,0.7)">.node</code> files with full fidelity:</p>
    
    <h4 style="font-size:1.25em;margin:24px 0 16px;font-weight:600;line-height:1.25;color:#fff">Import Process Flow</h4>
    
    <div style="margin:20px 0">
        <ol style="padding-left:2em;margin:0 0 16px;color:rgba(255,255,255,0.7)">
            <li style="margin-bottom:4px;color:rgba(255,255,255,0.7)"><strong style="font-weight:600;color:rgba(255,255,255,0.7)">File Validation</strong> - Verify ZIP structure and required components</li>
            <li style="margin-bottom:4px;color:rgba(255,255,255,0.7)"><strong style="font-weight:600;color:rgba(255,255,255,0.7)">Integrity Check</strong> - Validate package hash against contents</li>
            <li style="margin-bottom:4px;color:rgba(255,255,255,0.7)"><strong style="font-weight:600;color:rgba(255,255,255,0.7)">Temporary Extraction</strong> - Extract to secure temporary directory</li>
            <li style="margin-bottom:4px;color:rgba(255,255,255,0.7)"><strong style="font-weight:600;color:rgba(255,255,255,0.7)">Blend File Import</strong> - Use Blender's append system for node data</li>
            <li style="margin-bottom:4px;color:rgba(255,255,255,0.7)"><strong style="font-weight:600;color:rgba(255,255,255,0.7)">Context Placement</strong> - Place nodes at cursor or default location</li>
            <li style="margin-bottom:4px;color:rgba(255,255,255,0.7)"><strong style="font-weight:600;color:rgba(255,255,255,0.7)">Cleanup</strong> - Remove temporary files and update UI</li>
        </ol>
    </div>
    
    <h4>Multi-File Processing</h4>
    
    <p>The unpacker supports batch processing of multiple <code>.node</code> files:</p>
    
    <pre><code>def process_multiple_files(self, file_paths):
    success_count = 0
    error_count = 0
    error_messages = []
    
    for file_path in file_paths:
        success, message = self.unpack_node_file(file_path)
        if success:
            success_count += 1
        else:
            error_count += 1
            error_messages.append(message)
    
    return success_count, error_count, error_messages</code></pre>
    
    <h3>Context-Aware Node Placement</h3>
    
    <p>The system intelligently places imported nodes based on context:</p>
    
    <table>
        <tr>
            <td><strong>Context</strong></td>
            <td><strong>Placement Strategy</strong></td>
            <td><strong>Behavior</strong></td>
        </tr>
        <tr>
            <td>Single File Import</td>
            <td>Cursor Position</td>
            <td>Place at exact mouse coordinates</td>
        </tr>
        <tr>
            <td>Multiple File Import</td>
            <td>Default Location</td>
            <td>Place at node editor origin</td>
        </tr>
        <tr>
            <td>Background Import</td>
            <td>Scene Integration</td>
            <td>Add to library without placement</td>
        </tr>
    </table>
    
    <h2 style="font-size:1.5em;margin:24px 0 16px;font-weight:600;line-height:1.25;border-bottom:1px solid #2e3244;padding-bottom:0.3em;color:#fff"><span style="font-family:'Material Symbols Outlined';font-weight:normal;font-style:normal;font-size:28px;line-height:1;letter-spacing:normal;text-transform:none;display:inline-block;white-space:nowrap;word-wrap:normal;direction:ltr;-webkit-font-smoothing:antialiased;vertical-align:middle;margin-right:8px">desktop_windows</span>Windows Integration</h2>
    
    <h3>File Association System</h3>
    
    <p>The <code>FileAssociationManager</code> class handles Windows registry integration for seamless file handling:</p>
    
    <h4>Registry Structure</h4>
    
    <p>The addon creates the following registry entries:</p>
    
    <pre><code>HKEY_CURRENT_USER\Software\Classes\.node
    └── (Default) = "NodeFile"

HKEY_CURRENT_USER\Software\Classes\NodeFile
    ├── (Default) = "Node Archive File"
    ├── DefaultIcon
    │   └── (Default) = "C:\path\to\addon\icons\logo_xwz_ne.ico"
    └── shell\open\command
        └── (Default) = "C:\Program Files\7-Zip\7zFM.exe \"%1\""</code></pre>
    
    <h4>Archive Application Discovery</h4>
    
    <p>The system automatically detects suitable archive applications:</p>
    
    <ol>
        <li><strong>7-Zip Detection</strong> - Check standard installation paths and PATH environment</li>
        <li><strong>Registry Lookup</strong> - Query both 32-bit and 64-bit registry entries</li>
        <li><strong>WinRAR Fallback</strong> - Detect WinRAR installations if 7-Zip unavailable</li>
        <li><strong>System Default</strong> - Use Windows "Open With" dialog as last resort</li>
    </ol>
    
    <h3>Shell Integration Features</h3>
    
    <ul>
        <li><strong>Custom Icons</strong>: <code>.node</code> files display with custom XWZ icon</li>
        <li><strong>Context Menu</strong>: Right-click integration for "Open with Archive Manager"</li>
        <li><strong>Double-Click Handling</strong>: Direct access to file contents via archive viewer</li>
        <li><strong>Shell Notifications</strong>: Automatic icon cache refresh and file association updates</li>
    </ul>
    
    <h2 style="font-size:1.5em;margin:24px 0 16px;font-weight:600;line-height:1.25;border-bottom:1px solid #2e3244;padding-bottom:0.3em;color:#fff"><span style="font-family:'Material Symbols Outlined';font-weight:normal;font-style:normal;font-size:28px;line-height:1;letter-spacing:normal;text-transform:none;display:inline-block;white-space:nowrap;word-wrap:normal;direction:ltr;-webkit-font-smoothing:antialiased;vertical-align:middle;margin-right:8px">drag_handle</span>Drag & Drop System</h2>
    
    <h3>Drop Handler Implementation</h3>
    
    <p>The drag & drop system uses Blender's <code>FileHandler</code> API for seamless integration:</p>
    
    <pre><code>class NODE_FH_drop_handler(bpy.types.FileHandler):
    bl_idname = "NODE_FH_drop_handler"
    bl_label = "Node Drop Handler"
    bl_import_operator = "node.drop_handler"
    bl_file_extensions = ".node"
    
    @classmethod
    def poll_drop(cls, context):
        return True  // Accept drops in any context</code></pre>
    
    <h4>Mouse Coordinate Capture</h4>
    
    <p>Precise cursor positioning for intelligent node placement:</p>
    
    <pre><code>def invoke(self, context, event):
    self.mouse_x = event.mouse_region_x if hasattr(event, 'mouse_region_x') else 0
    self.mouse_y = event.mouse_region_y if hasattr(event, 'mouse_region_y') else 0
    
    // Pass coordinates to unpacker for placement</code></pre>
    
    <h3>Multi-File Batch Processing</h3>
    
    <p>The handler efficiently processes multiple files dropped simultaneously:</p>
    
    <div style="margin:20px 0">
        <h4 style="font-size:1.25em;margin:24px 0 16px;font-weight:600;line-height:1.25;color:#fff">Processing Pipeline</h4>
        <ol style="padding-left:2em;margin:0 0 16px;color:rgba(255,255,255,0.7)">
            <li style="margin-bottom:4px;color:rgba(255,255,255,0.7)"><strong style="font-weight:600;color:rgba(255,255,255,0.7)">File Validation</strong> - Filter <code style="padding:0.2em 0.4em;margin:0;font-size:85%;background-color:#2e3244;border-radius:3px;font-family:SFMono-Regular,Consolas,'Liberation Mono',Menlo,monospace;border:1px solid #3b4055;color:rgba(255,255,255,0.7)">.node</code> files from mixed drops</li>
            <li style="margin-bottom:4px;color:rgba(255,255,255,0.7)"><strong style="font-weight:600;color:rgba(255,255,255,0.7)">Path Resolution</strong> - Convert relative paths to absolute paths</li>
            <li style="margin-bottom:4px;color:rgba(255,255,255,0.7)"><strong style="font-weight:600;color:rgba(255,255,255,0.7)">Batch Processing</strong> - Process all valid files in sequence</li>
            <li style="margin-bottom:4px;color:rgba(255,255,255,0.7)"><strong style="font-weight:600;color:rgba(255,255,255,0.7)">Error Aggregation</strong> - Collect and report processing results</li>
            <li style="margin-bottom:4px;color:rgba(255,255,255,0.7)"><strong style="font-weight:600;color:rgba(255,255,255,0.7)">UI Feedback</strong> - Provide detailed success/failure notifications</li>
        </ol>
    </div>
    
    <h2 style="font-size:1.5em;margin:24px 0 16px;font-weight:600;line-height:1.25;border-bottom:1px solid #2e3244;padding-bottom:0.3em;color:#fff"><span style="font-family:'Material Symbols Outlined';font-weight:normal;font-style:normal;font-size:28px;line-height:1;letter-spacing:normal;text-transform:none;display:inline-block;white-space:nowrap;word-wrap:normal;direction:ltr;-webkit-font-smoothing:antialiased;vertical-align:middle;margin-right:8px">tune</span>Configuration & Settings</h2>
    
    <h3>Addon Manifest Configuration</h3>
    
    <pre><code>schema_version = "1.0.0"
id = "node_file_link"
name = "Node File Link"
tagline = "The base functionality for the .node extension"
version = "1.0.0"
type = "add-on"
maintainer = "XWZ"
website = "https://xwz.app"
license = ["MIT"]
blender_version_min = "4.1.0"</code></pre>
    
    <h3>Package Creation System</h3>
    
    <p>The <code>package.bat</code> script creates optimized <code>.node</code> files with integrity verification:</p>
    
    <h4>PowerShell Integration</h4>
    
    <p>Uses .NET compression APIs for cross-platform compatibility:</p>
    
    <pre><code>Add-Type -AssemblyName System.IO.Compression.FileSystem
$zip = [System.IO.Compression.ZipFile]::Open('output.node', 'Create')

// Add files with proper directory structure
// Calculate SHA256 hash for integrity
// Create .config file with validation data</code></pre>
    
    <h4>Hash Calculation Algorithm</h4>
    
    <ol>
        <li>Calculate SHA256 hash for each file in package</li>
        <li>Sort hashes alphabetically for consistency</li>
        <li>Combine all hashes with pipe separator</li>
        <li>Calculate final SHA256 hash of combined string</li>
        <li>Store in <code>.config</code> file for validation</li>
    </ol>
    
    <h2 style="font-size:1.5em;margin:24px 0 16px;font-weight:600;line-height:1.25;border-bottom:1px solid #2e3244;padding-bottom:0.3em;color:#fff"><span style="font-family:'Material Symbols Outlined';font-weight:normal;font-style:normal;font-size:28px;line-height:1;letter-spacing:normal;text-transform:none;display:inline-block;white-space:nowrap;word-wrap:normal;direction:ltr;-webkit-font-smoothing:antialiased;vertical-align:middle;margin-right:8px">api</span>API Reference</h2>
    
    <h3>Core Classes</h3>
    
    <h4>NodeGroupSerializer</h4>
    
    <table>
        <tr>
            <td><strong>Method</strong></td>
            <td><strong>Parameters</strong></td>
            <td><strong>Returns</strong></td>
        </tr>
        <tr>
            <td><code>serialize_nodegroup()</code></td>
            <td><code>node_tree, output_directory, package_name</code></td>
            <td><code>bool</code> (success status)</td>
        </tr>
        <tr>
            <td><code>_create_metadata_json()</code></td>
            <td>None</td>
            <td><code>bool</code> (creation success)</td>
        </tr>
        <tr>
            <td><code>_create_blend_file()</code></td>
            <td>None</td>
            <td><code>bool</code> (export success)</td>
        </tr>
    </table>
    
    <h4>NodeGroupUnpacker</h4>
    
    <table>
        <tr>
            <td><strong>Method</strong></td>
            <td><strong>Parameters</strong></td>
            <td><strong>Returns</strong></td>
        </tr>
        <tr>
            <td><code>unpack_node_file()</code></td>
            <td><code>filepath: str</code></td>
            <td><code>Tuple[bool, str]</code> (success, message)</td>
        </tr>
        <tr>
            <td><code>process_multiple_files()</code></td>
            <td><code>file_paths: List[str]</code></td>
            <td><code>Tuple[int, int, List[str]]</code> (success_count, error_count, errors)</td>
        </tr>
        <tr>
            <td><code>set_mouse_coordinates()</code></td>
            <td><code>x: int, y: int</code></td>
            <td>None</td>
        </tr>
    </table>
    
    <h4>FileAssociationManager</h4>
    
    <table>
        <tr>
            <td><strong>Method</strong></td>
            <td><strong>Parameters</strong></td>
            <td><strong>Returns</strong></td>
        </tr>
        <tr>
            <td><code>perform_file_association()</code></td>
            <td>None</td>
            <td><code>bool</code> (registration success)</td>
        </tr>
        <tr>
            <td><code>find_archive_application()</code></td>
            <td>None</td>
            <td><code>str</code> (application path)</td>
        </tr>
        <tr>
            <td><code>check_existing_association()</code></td>
            <td>None</td>
            <td><code>str | None</code> (existing ProgID)</td>
        </tr>
    </table>
    
    <h2 style="font-size:1.5em;margin:24px 0 16px;font-weight:600;line-height:1.25;border-bottom:1px solid #2e3244;padding-bottom:0.3em;color:#fff"><span style="font-family:'Material Symbols Outlined';font-weight:normal;font-style:normal;font-size:28px;line-height:1;letter-spacing:normal;text-transform:none;display:inline-block;white-space:nowrap;word-wrap:normal;direction:ltr;-webkit-font-smoothing:antialiased;vertical-align:middle;margin-right:8px">code</span>Development Guidelines</h2>
    
    <h3>Extending the System</h3>
    
    <p>For developers looking to extend or modify the addon:</p>
    
    <ul>
        <li><strong>Custom Serializers</strong>: Inherit from <code>NodeGroupSerializer</code> for specialized node types</li>
        <li><strong>Additional File Formats</strong>: Implement new packers/unpackers following the established pattern</li>
        <li><strong>Platform Support</strong>: Add file association managers for macOS and Linux</li>
        <li><strong>UI Extensions</strong>: Integrate additional operators into Blender's interface</li>
    </ul>
    
    <h2 style="font-size:1.5em;margin:24px 0 16px;font-weight:600;line-height:1.25;border-bottom:1px solid #2e3244;padding-bottom:0.3em;color:#fff"><span style="font-family:'Material Symbols Outlined';font-weight:normal;font-style:normal;font-size:28px;line-height:1;letter-spacing:normal;text-transform:none;display:inline-block;white-space:nowrap;word-wrap:normal;direction:ltr;-webkit-font-smoothing:antialiased;vertical-align:middle;margin-right:8px">analytics</span>Technical Specifications</h2>
    
    <table>
        <tr>
            <td><strong>Specification</strong></td>
            <td><strong>Value</strong></td>
            <td><strong>Notes</strong></td>
        </tr>
        <tr>
            <td>File Format Version</td>
            <td>1.0.0</td>
            <td>Current format specification</td>
        </tr>
        <tr>
            <td>Supported Node Types</td>
            <td>GeometryNodeTree</td>
            <td>Primary focus on Geometry Nodes</td>
        </tr>
        <tr>
            <td>Blender Compatibility</td>
            <td>4.1.0+</td>
            <td>Modern extension system required</td>
        </tr>
        <tr>
            <td>Platform Support</td>
            <td>Windows</td>
            <td>macOS and Linux support planned</td>
        </tr>
        <tr>
            <td>Maximum File Size</td>
            <td>Unlimited</td>
            <td>Limited by available system memory</td>
        </tr>
        <tr>
            <td>Compression</td>
            <td>ZIP (deflate)</td>
            <td>Standard compression for portability</td>
        </tr>
        <tr>
            <td>Hash Algorithm</td>
            <td>SHA256</td>
            <td>Cryptographic integrity verification</td>
        </tr>
        <tr>
            <td>Character Encoding</td>
            <td>UTF-8</td>
            <td>Universal text encoding support</td>
        </tr>
    </table>
    
    <h2 style="font-size:1.5em;margin:24px 0 16px;font-weight:600;line-height:1.25;border-bottom:1px solid #2e3244;padding-bottom:0.3em;color:#fff"><span style="font-family:'Material Symbols Outlined';font-weight:normal;font-style:normal;font-size:28px;line-height:1;letter-spacing:normal;text-transform:none;display:inline-block;white-space:nowrap;word-wrap:normal;direction:ltr;-webkit-font-smoothing:antialiased;vertical-align:middle;margin-right:8px">history</span>Changelog</h2>
    
    <ul style="padding-left:2em;margin:0 0 16px;color:rgba(255,255,255,0.7)">
        <li style="margin-bottom:4px;color:rgba(255,255,255,0.7)"><strong style="font-weight:600;color:rgba(255,255,255,0.7)">Version 1.0.0 (September 2025)</strong>: Initial release with core functionality</li>
    </ul>
</div>
